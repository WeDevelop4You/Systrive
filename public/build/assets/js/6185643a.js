var f=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)};var m=(e,t,s)=>(f(e,t,"read from private field"),s?s.call(e):t.get(e)),h=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},$=(e,t,s,a)=>(f(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);var d=(e,t,s)=>(f(e,t,"access private method"),s);import{V as T,F as y,h as I}from"./5ecbb865.js";import{S as E,a as P,b}from"./08a971a8.js";function O(e,t,s){const a=t<0?e.length+t:t;if(a>=0&&a<e.length){const r=s<0?e.length+s:s,[o]=e.splice(t,1);e.splice(r,0,o)}}const S=T.prototype,R=()=>({namespaced:!0,state:()=>({status:"loading",items:[],headers:[],customItems:[],meta:{total:-1,params:{},routes:{items:"",headers:""}}}),mutations:{setRoutes(e,t){e.meta.routes=t},setItemRoute(e,t){e.meta.routes.items=t},setParams(e,t){e.status="set_params",e.meta.params=t},setHeaders(e,t){e.headers=t.headers,e.customItems=t.customItems},setItems(e,t){e.items=t},addItem(e,t){e.items.push(t)},addItemAtIndex(e,{data:t,index:s}){e.items.splice(s,0,t)},replaceItem(e,{data:t,index:s}){e.items.splice(s,1,t)},replaceItemAtIndex(e,{data:t,originalIndex:s,index:a}){e.items[s]=t,O(e.items,s,a)},deleteItem(e,t){e.items.splice(t,1)},setTotal(e,t){e.meta.total=t},resetParams(e){e.status="reset_params"},reset(e){e.items=[],e.headers=[],e.customItems=[],e.meta.total=-1,e.status="loading"}},getters:{status(e){return e.status},headers(e){return e.headers},customItems(e){return e.customItems},items(e){return e.items},total(e){return e.meta.total}},actions:{getHeaders({state:e,commit:t}){S.$api.call({url:e.meta.routes.headers,method:"GET"}).then(s=>{t("setHeaders",s.data)})},getItems({state:e,commit:t},s=!1){return S.$api.call({url:e.meta.routes.items,method:"GET",params:e.meta.params,silence:s}).then(a=>{const r=a.data.data;t("setItems",r.items),t("setTotal",r.meta.total)})},reset({commit:e,dispatch:t}){e("reset"),t("getHeaders"),e("resetParams")}}}),c=T.prototype,H={namespaced:!0,actions:{create({commit:e},t){c.$api.call({url:t,method:"GET"}).then(s=>{e("form/setCreate",s.data.data)})},store({commit:e,getters:t},s){return c.$api.call({url:s,method:"POST",data:t["form/data"]}).catch(a=>(e("form/setErrors",a.response.data.errors),Promise.reject()))},edit({commit:e},t){c.$api.call({url:t,method:"GET"}).then(s=>{e("form/setEdit",s.data.data)}).catch(()=>{c.$state.resetForm()})},update({commit:e,getters:t},s){const a=t["form/data"];return c.$api.call({url:s,method:"PATCH",data:{roles:a.roles,permissions:a.permissions}}).catch(r=>(e("form/setErrors",r.response.data.errors),Promise.reject()))},states({dispatch:e},t){({[E]:()=>{e("create",c.$api.companyRoute("company.user.invite"))},[P]:()=>{e("edit",c.$api.companyRoute("company.user.edit",t.params.id))}})[t.state]()}},modules:{form:y(),dataTable:R()}},n=T.prototype,w={namespaced:!0,actions:{create({commit:e},t){n.$api.call({url:t,method:"GET"}).then(s=>{e("form/setCreate",s.data.data)})},store({commit:e,dispatch:t,getters:s},a){return n.$api.call({url:a,method:"POST",data:s["form/data"]}).catch(r=>{const o=r.response.data.errors||{};return e("form/setErrors",o),Object.prototype.hasOwnProperty.call(o,"permissions")&&t("popups/addPopup",I.createSimple(o.permissions[0]),{root:!0}),Promise.reject()})},edit({commit:e},t){n.$api.call({url:t,method:"GET"}).then(s=>{e("form/setEdit",s.data.data)})},update({commit:e,dispatch:t,getters:s},a){return n.$api.call({url:a,method:"PATCH",data:s["form/data"]}).catch(r=>{const o=r.response.data.errors||{};return e("form/setErrors",o),Object.prototype.hasOwnProperty.call(o,"permissions")&&t("popups/addPopup",I.createSimple(o.permissions[0]),{root:!0}),Promise.reject()})},states({dispatch:e},t){({[E]:()=>{e("create",n.$api.companyRoute("company.role.create"))},[P]:()=>{e("edit",n.$api.companyRoute("company.role.edit",t.params.id))}})[t.state]()}},modules:{form:y(),dataTable:R()}};var l,p,i,u;class C{constructor(t){h(this,i);h(this,l,void 0);h(this,p,{});$(this,l,t)}setForm(t,s){var r;let a={state:t?P:E,...s};d(r=this.setParams("form",a),i,u).call(r)}setShow(t){var a;const s={state:b,...t};d(a=this.setParams("show",s),i,u).call(a)}resetForm(){delete m(this,p).form,d(this,i,u).call(this)}resetShow(){delete m(this,p).show,d(this,i,u).call(this)}setParams(t,s){return Object.assign(m(this,p),{[t]:s}),this}}l=new WeakMap,p=new WeakMap,i=new WeakSet,u=function(){let t=[],s=m(this,l).currentRoute;for(let a of Object.entries(m(this,p)))t=t.concat(Object.values(a[1]));s.params.chapters=t,m(this,l).replace(s).catch(()=>{})};export{w as R,C as S,H as U,O as a,R as d};
